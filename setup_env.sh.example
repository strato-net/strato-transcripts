#!/bin/bash
# ==============================================================================
# Environment Variables for WhisperX Transcription + AI Post-Processing
# ==============================================================================
# Copy this file to setup_env.sh and fill in your API keys
# Only HF_TOKEN is required. AI provider keys are optional based on your usage.

# ==============================================================================
# REQUIRED: HuggingFace Token (for WhisperX diarization models)
# ==============================================================================
# Get your token from: https://huggingface.co/settings/tokens
# Accept model agreements at:
#   - https://huggingface.co/pyannote/speaker-diarization-3.1
#   - https://huggingface.co/pyannote/segmentation-3.0
export HF_TOKEN=""

# ==============================================================================
# OPTIONAL: AI Provider API Keys (for post-processing transcripts)
# ==============================================================================

# Anthropic (Claude Opus 4.5)
# Get key from: https://console.anthropic.com/
export ANTHROPIC_API_KEY=""

# Google (Gemini 3.0 Pro)
# Get key from: https://makersuite.google.com/app/apikey
export GOOGLE_API_KEY=""

# DeepSeek (DeepSeek-V3)
# Get key from: https://platform.deepseek.com/
export DEEPSEEK_API_KEY=""

# ==============================================================================
# OPTIONAL: Transcription Service API Keys
# ==============================================================================

# AssemblyAI (Cloud transcription with speaker diarization)
# Get key from: https://www.assemblyai.com/
export ASSEMBLYAI_API_KEY=""

# Replicate (Cloud WhisperX with speaker diarization)
# Get key from: https://replicate.com/account/api-tokens
export REPLICATE_API_TOKEN=""

# ==============================================================================
# PyTorch CUDA Library Path (for GPU operations)
# ==============================================================================
# Set LD_LIBRARY_PATH for CUDA libraries in this project's venv
# Only active when setup_env.sh is sourced (project-specific, not global)
PROJECT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VENV_DIR="$PROJECT_DIR/venv"

if [ -d "$VENV_DIR/lib/python3.12/site-packages/nvidia" ]; then
    export LD_LIBRARY_PATH="$VENV_DIR/lib/python3.12/site-packages/nvidia/cudnn/lib:$VENV_DIR/lib/python3.12/site-packages/nvidia/cublas/lib:$VENV_DIR/lib/python3.12/site-packages/nvidia/cu13/lib:$LD_LIBRARY_PATH"
fi

# ==============================================================================
# Display Configuration
# ==============================================================================
echo "Environment variables set"
if [ -n "$HF_TOKEN" ] && [ "$HF_TOKEN" != "" ]; then
  echo "  HF_TOKEN: SET"
else
  echo "  HF_TOKEN: NOT SET"
fi

if [ -n "$ANTHROPIC_API_KEY" ] && [ "$ANTHROPIC_API_KEY" != "" ]; then
  echo "  ANTHROPIC_API_KEY: SET"
else
  echo "  ANTHROPIC_API_KEY: NOT SET"
fi

if [ -n "$GOOGLE_API_KEY" ] && [ "$GOOGLE_API_KEY" != "" ]; then
  echo "  GOOGLE_API_KEY: SET"
else
  echo "  GOOGLE_API_KEY: NOT SET"
fi

if [ -n "$DEEPSEEK_API_KEY" ] && [ "$DEEPSEEK_API_KEY" != "" ]; then
  echo "  DEEPSEEK_API_KEY: SET"
else
  echo "  DEEPSEEK_API_KEY: NOT SET"
fi

if [ -n "$ASSEMBLYAI_API_KEY" ] && [ "$ASSEMBLYAI_API_KEY" != "" ]; then
  echo "  ASSEMBLYAI_API_KEY: SET"
else
  echo "  ASSEMBLYAI_API_KEY: NOT SET"
fi

if [ -n "$REPLICATE_API_TOKEN" ] && [ "$REPLICATE_API_TOKEN" != "" ]; then
  echo "  REPLICATE_API_TOKEN: SET"
else
  echo "  REPLICATE_API_TOKEN: NOT SET"
fi


echo ""
echo "See README.md for usage examples and documentation."
